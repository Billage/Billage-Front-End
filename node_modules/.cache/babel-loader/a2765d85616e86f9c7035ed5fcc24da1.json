{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sycho\\\\Desktop\\\\Front-End-master\\\\src\\\\components\\\\Chatting.jsx\",\n    _s = $RefreshSig$();\n\n/* eslint-disable array-callback-return */\nimport React, { useState, useEffect, useRef } from 'react';\nimport styled from \"styled-components\";\nimport '../ChatStyle.css';\nimport axios from 'axios';\nimport socketIo, { io } from 'socket.io-client';\nimport send from '../components/images/send.png';\nimport moment from \"moment\";\nimport { message } from 'antd';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TopStyled = styled.ul`\n    display: flex;\n    height: 25px;\n    align-items:center;\n    list-style:none;\n`;\n_c = TopStyled;\nconst Top = styled.div`\n    padding-top: 1px;\n    background-color: white;\n    //상단고정\n    position: sticky;\n    top: 0;\n    z-index: 1;\n`;\n_c2 = Top;\nconst ChatList = styled.div`\n  margin-left: 15px;\n  margin-right: 15px;\n  overflow-y: auto;\n`;\n_c3 = ChatList;\nconst msessage = styled.span`\n    // display: inline-block;\n    // padding: 7px 15px;\n    // margin-bottom: 20px;\n    // margin-top: 5px;\n`;\nconst Nick = styled.div`\n    font-size: 5px;\n    color: gray;\n    margin-bottom: -4px;\n`;\nconst InputStyled = styled.input`\n    margin: 5px 5px 5px 5px;\n    display: flex;\n    width: 95%;\n    border:none;\n    outline:none;\n`;\n_c4 = InputStyled;\nconst InputBox = styled.div`\n    margin: 5px 10px 5px 10px;\n    display: flex;\n    padding: 2px;\n    border: solid 1px lightgray;\n    border-radius : 10px;\n    height: 25px;\n    align-items:center;\n    background-color: white;\n`;\n_c5 = InputBox;\nconst Bottom = styled.div`\n  background-color: white;\n  // 하단고정\n    position: fixed;\n    bottom:0px;\n    width: 100%;\n`;\n_c6 = Bottom;\nconst Button = styled.button`\n    border: none;\n    background: none;\n    margin-top: 3px;\n`; //날짜 스타일 \n\n_c7 = Button;\nconst Line = styled.div`\n    display: flex;\n    flex-basis: 100%;\n    align-items : center;\n    color: rgba(0, 0, 0, 0.35);\n    font-size: 13px;\n    margin: 8px 0px;\n    ::before {\n      content: \"\";\n      flex-grow: 1;\n      margin: 0px 16px;\n      background: rgba(0, 0, 0, 0.35);\n      height: 1px;\n      line-height: 0px;\n    }\n    ::after {\n      content: \"\";\n      flex-grow: 1;\n      margin: 0px 16px;\n      background: rgba(0, 0, 0, 0.35);\n      height: 1px;\n      line-height: 0px;\n    }\n`; //시간 스타일\n\n_c8 = Line;\nconst MyTime = styled.span`\n    color: gray;\n    font-size: 5px;\n    margin-right: 4px;\n`;\n_c9 = MyTime;\nconst AnotherTime = styled.span`\n    color: gray;\n    font-size: 5px;\n    margin-left: 4px;\n`;\n_c10 = AnotherTime;\n\nconst Chatting = props => {\n  _s();\n\n  const [roomId, setRoomId] = useState('');\n  const [userInfo, setUserInfo] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = React.useState(\"\"); //채팅 입력 값\n\n  const post = {\n    postId: props.match.params.post\n  };\n\n  const createRoom = () => {\n    return axios.post(\"http://localhost:7000/chat\", post, {\n      withCredentials: true\n    });\n  };\n\n  const getUser = () => {\n    return axios.get(\"http://localhost:7000/auth\", {\n      withCredentials: true\n    });\n  };\n\n  const io = socketIo(\"http://localhost:7000/chat\");\n  const mounted = useRef(false);\n  useEffect(() => {\n    axios.all([createRoom(), getUser()]).then(axios.spread((room, user) => {\n      setRoomId(room.data);\n      setUserInfo(user);\n    }));\n  }, []);\n  useEffect(() => {\n    if (!mounted.current) {\n      mounted.current = true;\n    } else {\n      io.emit('join', roomId);\n    }\n  }, [roomId]);\n\n  const sendMessage = messageBody => {\n    io.emit(\"chat\", {\n      roomId: roomId,\n      body: messageBody,\n      senderId: userInfo.data.id,\n      timeStamp: moment().format('YYYY-MM-DD hh:mm'),\n      date: moment().format('YYYY년 MM월 DD일')\n    });\n    return {\n      message,\n      sendMessage\n    };\n  };\n\n  const onSendMessage = () => {\n    sendMessage(newMessage);\n    setNewMessage(\"\");\n  }; // const handleNewMessageChange = (event) => {\n  //   setNewMessage(event.target.value);\n  //   console.log(newMessage);\n  // };\n  //뒤로가기 icon \n\n\n  const backClick = () => {\n    window.history.back();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Top, {\n      children: [/*#__PURE__*/_jsxDEV(TopStyled, {\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          onClick: backClick,\n          style: {\n            'color': 'gray'\n          },\n          children: \"\\u2B05\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          style: {\n            'margin-left': '15px',\n            'font-weight': 'bold'\n          },\n          children: \"\\uC5B4\\uD53C\\uCE58\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(ChatList, {\n        children: messages.map(msg => {\n          msg.ownedByCurrentUser ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"myChat\",\n              children: [/*#__PURE__*/_jsxDEV(MyTime, {\n                children: msg.timeStamp\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"msg\",\n                children: msg.body\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"anotherChat\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"msg\",\n                children: msg.body\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 201,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(AnotherTime, {\n                children: msg.timeStamp\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ChatList, {\n        children: [/*#__PURE__*/_jsxDEV(Line, {\n          children: \"2021\\uB144 9\\uC6D4 11\\uC77C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"myChat\",\n          children: [/*#__PURE__*/_jsxDEV(MyTime, {\n            children: \"\\uC624\\uD6C4 2:40\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"msg\",\n            children: \"\\uC548\\uB155\\uD558\\uC138\\uC694!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"myChat\",\n          children: [/*#__PURE__*/_jsxDEV(MyTime, {\n            children: \"\\uC624\\uD6C4 2:40\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"msg\",\n            children: \"9\\uC6D4 19\\uC77C\\uAE4C\\uC9C0 \\uBE4C\\uB9B4 \\uC218 \\uC788\\uC744\\uAE4C\\uC694?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"anotherChat\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"msg\",\n            children: \"\\uB124 \\uAC00\\uB2A5\\uD569\\uB2C8\\uB2E4 : )\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(AnotherTime, {\n            children: \"\\uC624\\uD6C4 3:20\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"anotherChat\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"msg\",\n            children: \"\\uC5B4\\uB514\\uC11C \\uB9CC\\uB0A0\\uAE4C\\uC694?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(AnotherTime, {\n            children: \"\\uC624\\uD6C4 3:20\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"myChat\",\n          children: [/*#__PURE__*/_jsxDEV(MyTime, {\n            children: \"\\uC624\\uD6C4 3:22\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"msg\",\n            children: \"\\uC81C\\uAC00 \\uC9C0\\uCD95\\uC5ED\\uC73C\\uB85C \\uAC08\\uAC8C\\uC694!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Bottom, {\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: onSendMessage,\n        children: /*#__PURE__*/_jsxDEV(InputBox, {\n          children: [/*#__PURE__*/_jsxDEV(InputStyled, {\n            onChange: event => setNewMessage(event.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: send,\n              alt: \"\",\n              style: {\n                width: '20px',\n                height: 'auto'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 7\n  }, this);\n};\n\n_s(Chatting, \"Tt6rEVtvLhH8szVOo8SaJNRzkLU=\");\n\n_c11 = Chatting;\nexport default Chatting;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11;\n\n$RefreshReg$(_c, \"TopStyled\");\n$RefreshReg$(_c2, \"Top\");\n$RefreshReg$(_c3, \"ChatList\");\n$RefreshReg$(_c4, \"InputStyled\");\n$RefreshReg$(_c5, \"InputBox\");\n$RefreshReg$(_c6, \"Bottom\");\n$RefreshReg$(_c7, \"Button\");\n$RefreshReg$(_c8, \"Line\");\n$RefreshReg$(_c9, \"MyTime\");\n$RefreshReg$(_c10, \"AnotherTime\");\n$RefreshReg$(_c11, \"Chatting\");","map":{"version":3,"sources":["C:/Users/sycho/Desktop/Front-End-master/src/components/Chatting.jsx"],"names":["React","useState","useEffect","useRef","styled","axios","socketIo","io","send","moment","message","TopStyled","ul","Top","div","ChatList","msessage","span","Nick","InputStyled","input","InputBox","Bottom","Button","button","Line","MyTime","AnotherTime","Chatting","props","roomId","setRoomId","userInfo","setUserInfo","messages","setMessages","newMessage","setNewMessage","post","postId","match","params","createRoom","withCredentials","getUser","get","mounted","all","then","spread","room","user","data","current","emit","sendMessage","messageBody","body","senderId","id","timeStamp","format","date","onSendMessage","backClick","window","history","back","map","msg","ownedByCurrentUser","event","target","value","width","height"],"mappings":"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","sourcesContent":["/* eslint-disable array-callback-return */\nimport React, { useState, useEffect, useRef } from 'react'\nimport styled from \"styled-components\";\nimport '../ChatStyle.css';\nimport axios from 'axios';\nimport socketIo, { io } from 'socket.io-client';\nimport send from '../components/images/send.png';\nimport moment from \"moment\";\nimport { message } from 'antd';\n\nconst TopStyled = styled.ul`\n    display: flex;\n    height: 25px;\n    align-items:center;\n    list-style:none;\n`;\nconst Top = styled.div`\n    padding-top: 1px;\n    background-color: white;\n    //상단고정\n    position: sticky;\n    top: 0;\n    z-index: 1;\n`;\nconst ChatList = styled.div`\n  margin-left: 15px;\n  margin-right: 15px;\n  overflow-y: auto;\n`;\n\nconst msessage = styled.span`\n    // display: inline-block;\n    // padding: 7px 15px;\n    // margin-bottom: 20px;\n    // margin-top: 5px;\n`;\n\nconst Nick = styled.div`\n    font-size: 5px;\n    color: gray;\n    margin-bottom: -4px;\n`;\n\nconst InputStyled = styled.input`\n    margin: 5px 5px 5px 5px;\n    display: flex;\n    width: 95%;\n    border:none;\n    outline:none;\n`;\nconst InputBox = styled.div`\n    margin: 5px 10px 5px 10px;\n    display: flex;\n    padding: 2px;\n    border: solid 1px lightgray;\n    border-radius : 10px;\n    height: 25px;\n    align-items:center;\n    background-color: white;\n`;\nconst Bottom = styled.div`\n  background-color: white;\n  // 하단고정\n    position: fixed;\n    bottom:0px;\n    width: 100%;\n`;\n\nconst Button = styled.button`\n    border: none;\n    background: none;\n    margin-top: 3px;\n`;\n\n//날짜 스타일 \nconst Line = styled.div`\n    display: flex;\n    flex-basis: 100%;\n    align-items : center;\n    color: rgba(0, 0, 0, 0.35);\n    font-size: 13px;\n    margin: 8px 0px;\n    ::before {\n      content: \"\";\n      flex-grow: 1;\n      margin: 0px 16px;\n      background: rgba(0, 0, 0, 0.35);\n      height: 1px;\n      line-height: 0px;\n    }\n    ::after {\n      content: \"\";\n      flex-grow: 1;\n      margin: 0px 16px;\n      background: rgba(0, 0, 0, 0.35);\n      height: 1px;\n      line-height: 0px;\n    }\n`;\n//시간 스타일\nconst MyTime = styled.span`\n    color: gray;\n    font-size: 5px;\n    margin-right: 4px;\n`;\nconst AnotherTime = styled.span`\n    color: gray;\n    font-size: 5px;\n    margin-left: 4px;\n`;\n\nconst Chatting = (props) => {\n    const [roomId, setRoomId] = useState('');\n    const [userInfo, setUserInfo] = useState('');\n    const [messages, setMessages] = useState([]);\n    const [newMessage, setNewMessage] = React.useState(\"\"); //채팅 입력 값\n\n    const post = {\n      postId: props.match.params.post\n    };\n\n    const createRoom = () => {\n      return axios.post(\"http://localhost:7000/chat\", post, { withCredentials: true })\n    };\n\n    const getUser = () => {\n      return axios.get(\"http://localhost:7000/auth\", { withCredentials: true })\n    };\n\n    const io = socketIo(\"http://localhost:7000/chat\");\n\n    const mounted = useRef(false);\n\n    useEffect(()=>{\n        axios.all([createRoom(), getUser()])\n          .then(axios.spread((room, user) => {\n            setRoomId(room.data);\n            setUserInfo(user);\n          }))\n    }, []);\n\n    useEffect(()=>{\n      if(!mounted.current){\n        mounted.current=true;\n      }else{\n        io.emit('join', roomId);\n      }\n    }, [roomId]);\n\n\n    const sendMessage = (messageBody) => {\n      io.emit(\"chat\", {\n        roomId: roomId,\n        body: messageBody,\n        senderId: userInfo.data.id,\n        timeStamp : moment().format('YYYY-MM-DD hh:mm'),\n        date : moment().format('YYYY년 MM월 DD일'), \n      }); \n      return { message, sendMessage };\n    };\n\n    const onSendMessage = () => {\n      sendMessage(newMessage);\n      setNewMessage(\"\");\n    };\n    \n    // const handleNewMessageChange = (event) => {\n    //   setNewMessage(event.target.value);\n    //   console.log(newMessage);\n    // };\n    //뒤로가기 icon \n    const backClick = () => {\n      window.history.back();\n    }\n\n    return (\n      <div>\n        <Top> \n          <TopStyled>\n              <li onClick={backClick} style={{'color' : 'gray'}}>⬅</li>\n              <li style={{'margin-left' : '15px', 'font-weight' : 'bold'}}>어피치</li>\n              {/* <li style={{'margin-left' : '15px', 'font-weight' : 'bold'}}>{roomId}</li> */}\n          </TopStyled>\n        <hr/>\n        </Top>\n\n        <div>\n\n        <ChatList>\n          {messages.map((msg) => {\n            msg.ownedByCurrentUser ? (\n              <div>\n                <div className=\"myChat\">\n                <MyTime>{msg.timeStamp}</MyTime>\n                <span className=\"msg\">{msg.body}</span> \n                </div>\n              </div>\n            ) : (\n              <div>\n                <div className=\"anotherChat\">\n                <span className=\"msg\">{msg.body}</span>\n                <AnotherTime>{msg.timeStamp}</AnotherTime>\n                </div>\n              </div>\n            );\n          })}\n        </ChatList>\n\n            <ChatList>\n              <Line>2021년 9월 11일</Line>\n              <div className=\"myChat\">\n                <MyTime>오후 2:40</MyTime>\n                <span className=\"msg\">안녕하세요!</span> \n              </div>\n              <div className=\"myChat\">\n                <MyTime>오후 2:40</MyTime>\n                <span className=\"msg\">9월 19일까지 빌릴 수 있을까요?</span> \n              </div>\n              <div className=\"anotherChat\">\n                <span className=\"msg\">네 가능합니다 : )</span>\n                <AnotherTime>오후 3:20</AnotherTime>\n              </div>\n              <div className=\"anotherChat\">\n                <span className=\"msg\">어디서 만날까요?</span>\n                <AnotherTime>오후 3:20</AnotherTime>\n              </div>\n              <div className=\"myChat\">\n                <MyTime>오후 3:22</MyTime>\n                <span className=\"msg\">제가 지축역으로 갈게요!</span> \n              </div>\n            </ChatList> \n\n        </div>\n        <Bottom>\n          <form onSubmit={onSendMessage}>\n            <InputBox>\n              <InputStyled\n                onChange={(event) => setNewMessage(event.target.value)} \n              />\n              <Button>\n              <img src={send} alt=\"\" style={{width: '20px', height: 'auto'}}/>\n              </Button>\n            </InputBox>\n            </form>\n        </Bottom>\n\n      </div>\n    );\n  };\n\nexport default Chatting;"]},"metadata":{},"sourceType":"module"}